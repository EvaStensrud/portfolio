<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>boom!</title>
    <link rel="stylesheet" href="/style.css">
  </head>

  <body>
    
    <canvas></canvas>

    <overlay id="overlay">
        <div>sound on, click and boom!</div>
    </overlay>

      <p id="back"><a href="/"class="italic" font-family="'Sriracha', cursive;">Home</a></p>
      <!--<h1>press the a key. </h1>-->
<!--
<div id="overlay"></div>   
--> 
<script language="javascript" type="text/javascript" src="/_library/p5.min.js"></script>
<script src="path/to/p5.sound.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.3.1/addons/p5.sound.min.js"></script>   

<script src="/overlay.js"></script>

 <script>

const density = 'moBMOb ';
let img;

function preload() {
  img = loadImage("Onomatopoeia.webp");
  sound = loadSound("boom.mp3");
}

function setup() {
    createCanvas(1200, 400);
	/*w = img.width;
	h = img.height;
	ratial = w/h;
	max_h = map(img.height,0,img.height,0,windowHeight);
	max_w = max_h * ratial;
  createCanvas(max_w,max_h); */
	siz = 7;
}

function draw() {
  background(36, 9, 187);
	// image(gloria, 0, 0,max_w,max_h);
	// noLoop();
  let w = width / img.width;
  let h = height / img.height;
  img.loadPixels();
  for (let i = 0; i < img.width; i++) {
    for (let j = 0; j < img.height; j++) {
      const pixelIndex = (i + j * img.width) * 4;
      const r = img.pixels[pixelIndex + 0];
      const g = img.pixels[pixelIndex + 1];
      const b = img.pixels[pixelIndex + 2];
      const avg = (r + g + b) / 3;
      
      noStroke();
      fill(255, 255, 0);
      //square(i * w, j * h, w);
      
      const len = density.length;
      const charIndex = floor(map(avg,0,255,len,0));
      
      
      
      textSize(w*siz);
      textAlign(CENTER, CENTER);
      text(density.charAt(charIndex), i * w + w * 1, j * h + h * 1);
      
      j+=siz;
    }
		i+=siz;
  }
  noLoop();
  
}

function mousePressed(){
    sound.play();
}

</script>
</body>